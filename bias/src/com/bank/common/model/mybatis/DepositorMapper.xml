<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.bank.common.model.Depositor" >
  <resultMap id="depositorMap" type="Depositor" >
    <id column="id" property="id" />
    <result column="depositor_name" property="depositorName" />
    <result column="card_num" property="cardNum" />
    <result column="depositor_code" property="depositorCode"/>
    <result column="gender" property="gender" />
    <result column="birthday" property="birthday" />
    <result column="join_time" property="joinTime" />
    <result column="political_status" property="politicalStatus" />
    <result column="duty" property="duty" />
    <result column="work_time" property="workTime" />
    <result column="credit_level" property="creditLevel" />
    <result column="telephone" property="telephone" />
    <result column="mobile_phone" property="mobilePhone" />
    <result column="introducer" property="introducer" />
    <result column="address" property="address" />
    <result column="image" property="image" />
    <result column="org_id" property="orgId" />
    <result column="org_name" property="orgName" />
    <result column="is_deleted" property="isDeleted" />
    <result column="created_time" property="createdTime" />
    <result column="updated_time" property="updatedTime" />
  </resultMap>
  
  <sql id="pagination">
      <if test="offset != null and rowCount != null">
          <![CDATA[
              LIMIT #{offset},#{rowCount}
          ]]>
      </if>
  </sql>
  
  <sql id="selectAccount">
      SELECT
      ID, DEPOSITOR_NAME, CARD_NUM, DEPOSITOR_CODE, GENDER, BIRTHDAY, JOIN_TIME, POLITICAL_STATUS, 
  	  DUTY, WORK_TIME, CREDIT_LEVEL, TELEPHONE, MOBILE_PHONE, INTRODUCER, ADDRESS, IMAGE, 
  	  ORG_ID,ORG_NAME, IS_DELETED, date_format(CREATED_TIME, '%Y-%m-%d %H:%i:%s') as CREATED_TIME, date_format(UPDATED_TIME, '%Y-%m-%d %H:%i:%s') as UPDATED_TIME
  </sql>
  <select id="findAllDepositorByParams" parameterType="java.util.HashMap" resultMap="depositorMap">
       <include refid="selectAccount"></include>
       FROM DEPOSITOR DT WHERE DT.IS_DELETED = 0
       <if test="beginTime != null and beginTime != ''">
           AND DT.CREATED_TIME > #{beginTime}
       </if>
       <if test="endTime != null and endTime != ''">
           AND #{endTime} > DT.CREATED_TIME
       </if>
        ORDER BY DT.ID
       <include refid="pagination"></include>
   </select>
   <select id="getCount" parameterType="java.util.HashMap" resultType="java.lang.Integer">
        SELECT COUNT(ID) FROM DEPOSITOR DT
        WHERE DT.IS_DELETED = 0
        <if test="beginTime != null and beginTime != ''">
            AND DT.CREATED_TIME > #{beginTime}
        </if>
        <if test="endTime != null and endTime != ''">
            AND #{endTime} > DT.CREATED_TIME
        </if>
   </select>
    <select id="getById" parameterType="java.lang.Integer" resultMap="depositorMap">
        <include refid="selectAccount" />
        <![CDATA[
            FROM DEPOSITOR DT
            WHERE DT.ID = #{id} AND IS_DELETED = 0
        ]]>
    </select>
   <insert id="add" parameterType="Depositor" >
	    insert into depositor ( depositor_name, card_num, 
	      depositor_code, gender, birthday, 
	      join_time, political_status, duty, 
	      work_time, credit_level, telephone, 
	      mobile_phone, introducer, address, 
	      image, org_id,org_name)
	    values (#{depositorName}, #{cardNum}, 
	      #{depositorCode}, #{gender}, #{birthday}, 
	      #{joinTime}, #{politicalStatus}, #{duty}, 
	      #{workTime}, #{creditLevel}, #{telephone}, 
	      #{mobilePhone}, #{introducer}, #{address}, 
	      #{image}, #{orgId},#{orgName})
   </insert>
   <update id="update" parameterType="Depositor">
     update depositor
	    <set>
	      <if test="depositorName != null">
	        depositor_name = #{depositorName},
	      </if>
	      <if test="cardNum != null">
	        card_num = #{cardNum},
	      </if>
	      <if test="depositorCode != null">
	        depositor_code = #{depositorCode},
	      </if>
	      <if test="gender != null">
	        gender = #{gender},
	      </if>
	      <if test="birthday != null">
	        birthday = #{birthday},
	      </if>
	      <if test="joinTime != null">
	        join_time = #{joinTime},
	      </if>
	      <if test="politicalStatus != null">
	        political_status = #{politicalStatus},
	      </if>
	      <if test="duty != null">
	        duty = #{duty},
	      </if>
	      <if test="workTime != null">
	        work_time = #{workTime},
	      </if>
	      <if test="creditLevel != null">
	        credit_level = #{creditLevel},
	      </if>
	      <if test="telephone != null">
	        telephone = #{telephone},
	      </if>
	      <if test="mobilePhone != null">
	        mobile_phone = #{mobilePhone},
	      </if>
	      <if test="introducer != null">
	        introducer = #{introducer},
	      </if>
	      <if test="address != null">
	        address = #{address},
	      </if>
	      <if test="image != null">
	        image = #{image},
	      </if>
	      <if test="orgId != null">
	        org_id = #{orgId},
	      </if>
	      <if test="orgName != null">
            org_name = #{orgName},
          </if>
	      <if test="isDeleted != null">
	        is_deleted = #{isDeleted},
	      </if>
	      <if test="createdTime != null">
	        created_time = #{createdTime},
	      </if>
	      <if test="updatedTime != null">
	        updated_time = #{updatedTime},
	      </if>
	    </set>
	    where id = #{id}
   </update>
   <update id="deleteDepositorByIds" parameterType="java.util.List">
         <![CDATA[
           UPDATE DEPOSITOR DT SET DT.IS_DELETED = 1 WHERE DT.ID IN
        ]]>
        <foreach item="item" index="index" collection="list" open="(" separator="," close=")">  
          #{item}  
        </foreach>  
    </update>
  
</mapper>