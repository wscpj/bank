<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.bank.common.model.Depositor" >
  <resultMap id="depositorMap" type="Depositor" >
    <id column="id" property="id" jdbcType="INTEGER" />
    <result column="depositor_name" property="depositorName" jdbcType="VARCHAR" />
    <result column="card_num" property="cardNum" jdbcType="VARCHAR" />
    <result column="depositor_code" property="depositorCode" jdbcType="VARCHAR" />
    <result column="gender" property="gender" jdbcType="INTEGER" />
    <result column="birthday" property="birthday" jdbcType="TIMESTAMP" />
    <result column="join_time" property="joinTime" jdbcType="VARCHAR" />
    <result column="political_status" property="politicalStatus" jdbcType="INTEGER" />
    <result column="duty" property="duty" jdbcType="INTEGER" />
    <result column="work_time" property="workTime" jdbcType="INTEGER" />
    <result column="credit_level" property="creditLevel" jdbcType="INTEGER" />
    <result column="telephone" property="telephone" jdbcType="VARCHAR" />
    <result column="mobile_phone" property="mobilePhone" jdbcType="VARCHAR" />
    <result column="introducer" property="introducer" jdbcType="INTEGER" />
    <result column="address" property="address" jdbcType="VARCHAR" />
    <result column="image" property="image" jdbcType="VARCHAR" />
    <result column="org_id" property="orgId" jdbcType="INTEGER" />
    <result column="is_deleted" property="isDeleted" jdbcType="BIT" />
    <result column="created_time" property="createdTime" jdbcType="TIMESTAMP" />
    <result column="updated_time" property="updatedTime" jdbcType="TIMESTAMP" />
  </resultMap>
  
  <sql id="pagination">
      <if test="offset != null and rowCount != null">
          <![CDATA[
              LIMIT #{offset},#{rowCount}
          ]]>
      </if>
  </sql>
  
  <sql id="selectAccount">
      SELECT
      ID, DEPOSITOR_NAME, CARD_NUM, DEPOSITOR_CODE, GENDER, BIRTHDAY, JOIN_TIME, POLITICAL_STATUS, 
  	  DUTY, WORK_TIME, CREDIT_LEVEL, TELEPHONE, MOBILE_PHONE, INTRODUCER, ADDRESS, IMAGE, 
  	  ORG_ID, IS_DELETED, CREATED_TIME, UPDATED_TIME
  </sql>
  <select id="findAllDepositorByParams" parameterType="java.util.HashMap" resultMap="depositorMap">
       <include refid="selectAccount"></include>
       FROM DEPOSITOR DT WHERE DT.IS_DELETED = 0
       <if test="beginTime != null and beginTime != ''">
           AND DT.CREATED_TIME > #{beginTime}
       </if>
       <if test="endTime != null and endTime != ''">
           AND #{endTime} > DT.CREATED_TIME
       </if>
        ORDER BY DT.ID
       <include refid="pagination"></include>
   </select>
   <select id="getCount" parameterType="java.util.HashMap" resultType="java.lang.Integer">
        SELECT COUNT(ID) FROM DEPOSITOR DT
        WHERE DT.IS_DELETED = 0
        <if test="beginTime != null and beginTime != ''">
            AND DT.CREATED_TIME > #{beginTime}
        </if>
        <if test="endTime != null and endTime != ''">
            AND #{endTime} > DT.CREATED_TIME
        </if>
   </select>
    <select id="getById" parameterType="java.lang.Integer" resultMap="depositorMap">
        <include refid="selectAccount" />
        <![CDATA[
            FROM DEPOSITOR DT
            WHERE DT.ID = #{id} AND IS_DELETED = 0
        ]]>
    </select>
   <insert id="add" parameterType="Depositor" >
	    insert into depositor ( depositor_name, card_num, 
	      depositor_code, gender, birthday, 
	      join_time, political_status, duty, 
	      work_time, credit_level, telephone, 
	      mobile_phone, introducer, address, 
	      image, org_id)
	    values (#{depositorName,jdbcType=VARCHAR}, #{cardNum,jdbcType=VARCHAR}, 
	      #{depositorCode,jdbcType=VARCHAR}, #{gender,jdbcType=INTEGER}, #{birthday,jdbcType=TIMESTAMP}, 
	      #{joinTime,jdbcType=VARCHAR}, #{politicalStatus,jdbcType=INTEGER}, #{duty,jdbcType=INTEGER}, 
	      #{workTime,jdbcType=INTEGER}, #{creditLevel,jdbcType=INTEGER}, #{telephone,jdbcType=VARCHAR}, 
	      #{mobilePhone,jdbcType=VARCHAR}, #{introducer,jdbcType=INTEGER}, #{address,jdbcType=VARCHAR}, 
	      #{image,jdbcType=VARCHAR}, #{orgId,jdbcType=INTEGER})
   </insert>
   <update id="update" parameterType="Role">
        
     update depositor
	    <set>
	      <if test="depositorName != null">
	        depositor_name = #{depositorName,jdbcType=VARCHAR},
	      </if>
	      <if test="cardNum != null">
	        card_num = #{cardNum,jdbcType=VARCHAR},
	      </if>
	      <if test="depositorCode != null">
	        depositor_code = #{depositorCode,jdbcType=VARCHAR},
	      </if>
	      <if test="gender != null">
	        gender = #{gender,jdbcType=INTEGER},
	      </if>
	      <if test="birthday != null">
	        birthday = #{birthday,jdbcType=TIMESTAMP},
	      </if>
	      <if test="joinTime != null">
	        join_time = #{joinTime,jdbcType=VARCHAR},
	      </if>
	      <if test="politicalStatus != null">
	        political_status = #{politicalStatus,jdbcType=INTEGER},
	      </if>
	      <if test="duty != null">
	        duty = #{duty,jdbcType=INTEGER},
	      </if>
	      <if test="workTime != null">
	        work_time = #{workTime,jdbcType=INTEGER},
	      </if>
	      <if test="creditLevel != null">
	        credit_level = #{creditLevel,jdbcType=INTEGER},
	      </if>
	      <if test="telephone != null">
	        telephone = #{telephone,jdbcType=VARCHAR},
	      </if>
	      <if test="mobilePhone != null">
	        mobile_phone = #{mobilePhone,jdbcType=VARCHAR},
	      </if>
	      <if test="introducer != null">
	        introducer = #{introducer,jdbcType=INTEGER},
	      </if>
	      <if test="address != null">
	        address = #{address,jdbcType=VARCHAR},
	      </if>
	      <if test="image != null">
	        image = #{image,jdbcType=VARCHAR},
	      </if>
	      <if test="orgId != null">
	        org_id = #{orgId,jdbcType=INTEGER},
	      </if>
	      <if test="isDeleted != null">
	        is_deleted = #{isDeleted,jdbcType=BIT},
	      </if>
	      <if test="createdTime != null">
	        created_time = #{createdTime,jdbcType=TIMESTAMP},
	      </if>
	      <if test="updatedTime != null">
	        updated_time = #{updatedTime,jdbcType=TIMESTAMP},
	      </if>
	    </set>
	    where id = #{id,jdbcType=INTEGER}
    
   </update>
   <update id="deleteDepositorByIds" parameterType="java.util.List">
         <![CDATA[
           UPDATE DEPOSITOR DT SET DT.IS_DELETED = 1 WHERE DT.ID IN
        ]]>
        <foreach item="item" index="index" collection="list" open="(" separator="," close=")">  
          #{item}  
        </foreach>  
    </update>
  
</mapper>